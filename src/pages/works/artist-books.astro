---
import WorksLayout from "@components/WorksLayout.astro";
import WorkCard from "@components/WorkCard.astro";
import { WORKS } from "@data/works";
import { processImageUrl } from "@utils/images";

const artistBooksCategory = WORKS.find(
  (category) => category.slug === "artist-books"
);
if (!artistBooksCategory) throw new Error("Artist Books category not found");

const collections = artistBooksCategory.collections || [];

const getFirstImageFromCollection = (
  collection: (typeof collections)[0]
): string => {
  if (collection.works && collection.works.length > 0) {
    const work = collection.works[0];
    if (work.imageUrls && work.imageUrls.length > 0) {
      return processImageUrl(work.imageUrls[0]);
    }
  }
  return "";
};

const bannerImage =
  collections.length > 0
    ? getFirstImageFromCollection(collections[0])
    : undefined;

const description = `The artist book lends itself well to the adaption and exploration of sequential narrative story telling. Careful consideration is given to all design elements of the book including layout, typography, pagination, and cover designs. The artist can control all design elements and apply the handmade craft to produce unique artist books.`;
---

<WorksLayout
  title="Artist Books"
  description={description}
  bannerImage={bannerImage}
  breadcrumbs={[
    { label: "Home", href: "/" },
    { label: "Works", href: "/works" },
    { label: "Artist Books" },
  ]}
  introText={description}
  sectionTitle="Collections"
>
  {
    collections.map((collection, index) => (
      <div class="grid-item" style={`--delay: ${0.2 + index * 0.08}s`}>
        <WorkCard
          href={`/works/artist-books/${collection.slug}`}
          title={collection.title}
          subtitle=""
          imageUrl={getFirstImageFromCollection(collection)}
          imageAlt={`${collection.title} collection`}
          isAboveFold={index < 3}
        />
      </div>
    ))
  }
</WorksLayout>

<style>
  .grid-item {
    opacity: 0;
    animation: fadeInUp 0.6s var(--ease-out-expo, cubic-bezier(0.16, 1, 0.3, 1))
      forwards;
    animation-delay: var(--delay, 0s);
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .grid-item {
      opacity: 1;
      animation: none;
    }
  }
</style>
